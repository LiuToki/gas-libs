<!DOCTYPE html>
<html>
	<head>
		<base target="_top">
		<script>
			// Prevent forms from submitting.
			function preventFormSubmit() {
				var forms = document.querySelectorAll('form');
				for (var i = 0; i < forms.length; i++) {
					forms[i].addEventListener('submit', function(event) {
						event.preventDefault();
					});
				}
			}
			window.addEventListener('load', preventFormSubmit);

			function handleFormSubmit(formObject) {
				google.script.run.withSuccessHandler(updateUrl).callbackVisa(formObject);
			}

			function updateUrl(url) {
				var div = document.getElementById('output');
				div.innerHTML = '<a href="' + url + '">Got it!</a>';
			}
		</script>
	</head>
	<body>
	<form id="myForm" onsubmit="handleFormSubmit(this)">
		<div style="text-align: left;">
			<input name="myFile" type="file" />
		</div>
		<div style="text-align: left;">
			<label for="month-select">Select the month to extract:</label>
			<select name="month" id="month-select">
				<option value="1" selected>1:Jan.</option>
				<option value="2">2:Feb.</option>
				<option value="3">3:Mar.</option>
				<option value="4">4:Apr.</option>
				<option value="5">5:May</option>
				<option value="6">6:Jun.</option>
				<option value="7">7:Jul.</option>
				<option value="8">8:Aug.</option>
				<option value="9">9:Sep.</option>
				<option value="10">10:Oct.</option>
				<option value="11">11:Nov.</option>
				<option value="12">12:Dec.</option>
			</select>
		</div>
		<div style="text-align: right;">
			<input type="submit" value="Submit" />
		</div>
	</form>


	<div id="output"></div>
	</body>
</html>
